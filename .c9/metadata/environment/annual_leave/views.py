{"filter":false,"title":"views.py","tooltip":"/annual_leave/views.py","undoManager":{"mark":31,"position":31,"stack":[[{"start":{"row":217,"column":43},"end":{"row":218,"column":0},"action":"insert","lines":["",""],"id":49},{"start":{"row":218,"column":0},"end":{"row":218,"column":12},"action":"insert","lines":["            "]}],[{"start":{"row":218,"column":12},"end":{"row":223,"column":71},"action":"insert","lines":["#The next four lines of code instantiates the variables that will be used to check if the officer has enough leave remaining to make the request.  ","            start_time_date_leave_amount_check = datetime.datetime.combine(short_term_leave_form.instance.st_leave_date, short_term_leave_form.instance.st_leave_start_time)","            finish_time_date_leave_amount_check = datetime.datetime.combine(short_term_leave_form.instance.st_leave_date, short_term_leave_form.instance.st_leave_finish_time)","            leave_check_difference_as_delta = start_time_date_leave_amount_check - finish_time_date_leave_amount_check","            leave_amount_requested = getLeaveAmount(leave_check_difference_as_delta)","            officers_leave_remaining = request.user.current_leave_total"],"id":50}],[{"start":{"row":223,"column":71},"end":{"row":224,"column":0},"action":"insert","lines":["",""],"id":51},{"start":{"row":224,"column":0},"end":{"row":224,"column":12},"action":"insert","lines":["            "]},{"start":{"row":224,"column":12},"end":{"row":225,"column":0},"action":"insert","lines":["",""]},{"start":{"row":225,"column":0},"end":{"row":225,"column":12},"action":"insert","lines":["            "]},{"start":{"row":225,"column":12},"end":{"row":226,"column":0},"action":"insert","lines":["",""]},{"start":{"row":226,"column":0},"end":{"row":226,"column":12},"action":"insert","lines":["            "]}],[{"start":{"row":219,"column":75},"end":{"row":219,"column":96},"action":"remove","lines":["short_term_leave_form"],"id":52},{"start":{"row":219,"column":75},"end":{"row":219,"column":95},"action":"insert","lines":["edit_st_request_form"]}],[{"start":{"row":219,"column":120},"end":{"row":219,"column":141},"action":"remove","lines":["short_term_leave_form"],"id":53},{"start":{"row":219,"column":120},"end":{"row":219,"column":140},"action":"insert","lines":["edit_st_request_form"]}],[{"start":{"row":220,"column":76},"end":{"row":220,"column":97},"action":"remove","lines":["short_term_leave_form"],"id":54},{"start":{"row":220,"column":76},"end":{"row":220,"column":96},"action":"insert","lines":["edit_st_request_form"]}],[{"start":{"row":220,"column":121},"end":{"row":220,"column":142},"action":"remove","lines":["short_term_leave_form"],"id":55},{"start":{"row":220,"column":121},"end":{"row":220,"column":141},"action":"insert","lines":["edit_st_request_form"]}],[{"start":{"row":225,"column":12},"end":{"row":240,"column":75},"action":"insert","lines":["if short_term_leave_form.instance.st_leave_start_time > short_term_leave_form.instance.st_leave_finish_time:","                messages.error(request, \"The start time must be before the finish time.\")","                return render(request, \"submit_st_leave.html\", {'short_term_leave_form': short_term_leave_form})","            elif leave_amount_requested > officers_leave_remaining:","                messages.error(request, \"You do not have enough leave remaining to request this much leave.\")","                return render(request, \"submit_st_leave.html\", {'short_term_leave_form': short_term_leave_form})","            else:","                st_leave_request = short_term_leave_form.save()","                start_time_date = datetime.datetime.combine(st_leave_request.st_leave_date, st_leave_request.st_leave_start_time)","                finish_time_date = datetime.datetime.combine(st_leave_request.st_leave_date, st_leave_request.st_leave_finish_time)","                difference_as_delta = finish_time_date - start_time_date","                #print(st_leave_request.st_leave_amount)","                st_leave_request.st_leave_amount = getLeaveAmount(difference_as_delta)","                st_leave_request.save() #ISSUE","                messages.success(request, 'You have successfully submitted a short term leave request.')","                return redirect(view_st_leave_request, st_leave_request.pk)"],"id":56}],[{"start":{"row":224,"column":12},"end":{"row":224,"column":115},"action":"insert","lines":["#Server side validation to ensure leave request is logical and that officer has enough leave remaining."],"id":57}],[{"start":{"row":225,"column":15},"end":{"row":225,"column":36},"action":"remove","lines":["short_term_leave_form"],"id":58},{"start":{"row":225,"column":15},"end":{"row":225,"column":35},"action":"insert","lines":["edit_st_request_form"]}],[{"start":{"row":225,"column":67},"end":{"row":225,"column":88},"action":"remove","lines":["short_term_leave_form"],"id":59},{"start":{"row":225,"column":67},"end":{"row":225,"column":87},"action":"insert","lines":["edit_st_request_form"]}],[{"start":{"row":227,"column":65},"end":{"row":227,"column":86},"action":"remove","lines":["short_term_leave_form"],"id":60},{"start":{"row":227,"column":65},"end":{"row":227,"column":85},"action":"insert","lines":["edit_st_request_form"]}],[{"start":{"row":227,"column":88},"end":{"row":227,"column":109},"action":"remove","lines":["short_term_leave_form"],"id":61},{"start":{"row":227,"column":88},"end":{"row":227,"column":108},"action":"insert","lines":["edit_st_request_form"]}],[{"start":{"row":227,"column":40},"end":{"row":227,"column":60},"action":"remove","lines":["submit_st_leave.html"],"id":62},{"start":{"row":227,"column":40},"end":{"row":227,"column":60},"action":"insert","lines":["edit_st_request.html"]}],[{"start":{"row":227,"column":64},"end":{"row":227,"column":113},"action":"insert","lines":["'st_request_for_editing': st_request_for_editing,"],"id":63}],[{"start":{"row":227,"column":113},"end":{"row":227,"column":114},"action":"insert","lines":[" "],"id":64}],[{"start":{"row":230,"column":64},"end":{"row":230,"column":113},"action":"insert","lines":["'st_request_for_editing': st_request_for_editing,"],"id":65}],[{"start":{"row":230,"column":113},"end":{"row":230,"column":114},"action":"insert","lines":[" "],"id":66}],[{"start":{"row":230,"column":115},"end":{"row":230,"column":136},"action":"remove","lines":["short_term_leave_form"],"id":67},{"start":{"row":230,"column":115},"end":{"row":230,"column":135},"action":"insert","lines":["edit_st_request_form"]}],[{"start":{"row":230,"column":138},"end":{"row":230,"column":159},"action":"remove","lines":["short_term_leave_form"],"id":68},{"start":{"row":230,"column":138},"end":{"row":230,"column":158},"action":"insert","lines":["edit_st_request_form"]}],[{"start":{"row":230,"column":40},"end":{"row":230,"column":60},"action":"remove","lines":["submit_st_leave.html"],"id":69},{"start":{"row":230,"column":40},"end":{"row":230,"column":60},"action":"insert","lines":["edit_st_request.html"]}],[{"start":{"row":232,"column":16},"end":{"row":232,"column":63},"action":"remove","lines":["st_leave_request = short_term_leave_form.save()"],"id":70},{"start":{"row":232,"column":16},"end":{"row":232,"column":68},"action":"insert","lines":["st_request_for_editing = edit_st_request_form.save()"]}],[{"start":{"row":233,"column":60},"end":{"row":233,"column":76},"action":"remove","lines":["st_leave_request"],"id":71},{"start":{"row":233,"column":60},"end":{"row":233,"column":82},"action":"insert","lines":["st_request_for_editing"]}],[{"start":{"row":233,"column":98},"end":{"row":233,"column":114},"action":"remove","lines":["st_leave_request"],"id":72},{"start":{"row":233,"column":98},"end":{"row":233,"column":120},"action":"insert","lines":["st_request_for_editing"]}],[{"start":{"row":234,"column":61},"end":{"row":234,"column":77},"action":"remove","lines":["st_leave_request"],"id":73},{"start":{"row":234,"column":61},"end":{"row":234,"column":83},"action":"insert","lines":["st_request_for_editing"]}],[{"start":{"row":234,"column":99},"end":{"row":234,"column":115},"action":"remove","lines":["st_leave_request"],"id":74},{"start":{"row":234,"column":99},"end":{"row":234,"column":121},"action":"insert","lines":["st_request_for_editing"]}],[{"start":{"row":237,"column":16},"end":{"row":237,"column":32},"action":"remove","lines":["st_leave_request"],"id":75},{"start":{"row":237,"column":16},"end":{"row":237,"column":38},"action":"insert","lines":["st_request_for_editing"]}],[{"start":{"row":238,"column":16},"end":{"row":238,"column":32},"action":"remove","lines":["st_leave_request"],"id":76},{"start":{"row":238,"column":16},"end":{"row":238,"column":38},"action":"insert","lines":["st_request_for_editing"]}],[{"start":{"row":239,"column":65},"end":{"row":239,"column":103},"action":"remove","lines":["submitted a short term leave request.'"],"id":77},{"start":{"row":239,"column":65},"end":{"row":239,"column":112},"action":"insert","lines":["made changes to this short term leave request.'"]}],[{"start":{"row":240,"column":55},"end":{"row":240,"column":71},"action":"remove","lines":["st_leave_request"],"id":78},{"start":{"row":240,"column":55},"end":{"row":240,"column":77},"action":"insert","lines":["st_request_for_editing"]}],[{"start":{"row":242,"column":12},"end":{"row":244,"column":77},"action":"remove","lines":["st_request_for_editing = edit_st_request_form.save()","            messages.success(request, 'You have successfully made changes to this short term leave request.')","            return redirect(view_st_leave_request, st_request_for_editing.pk)"],"id":79},{"start":{"row":242,"column":8},"end":{"row":242,"column":12},"action":"remove","lines":["    "]},{"start":{"row":242,"column":4},"end":{"row":242,"column":8},"action":"remove","lines":["    "]},{"start":{"row":242,"column":0},"end":{"row":242,"column":4},"action":"remove","lines":["    "]},{"start":{"row":241,"column":12},"end":{"row":242,"column":0},"action":"remove","lines":["",""]},{"start":{"row":241,"column":8},"end":{"row":241,"column":12},"action":"remove","lines":["    "]},{"start":{"row":241,"column":4},"end":{"row":241,"column":8},"action":"remove","lines":["    "]}],[{"start":{"row":241,"column":0},"end":{"row":241,"column":4},"action":"remove","lines":["    "],"id":80},{"start":{"row":240,"column":81},"end":{"row":241,"column":0},"action":"remove","lines":["",""]}]]},"ace":{"folds":[],"scrolltop":3052,"scrollleft":0,"selection":{"start":{"row":218,"column":81},"end":{"row":218,"column":81},"isBackwards":true},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":217,"state":"start","mode":"ace/mode/python"}},"timestamp":1615295308755,"hash":"9567433df38a1b45e4e7017e81614296f12dc9cf"}